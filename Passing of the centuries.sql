/*Use a complex CASE statement to show the number of events for each century, including the CUBE function.

*/

SELECT * FROM TBLEVENT;

SELECT CASE WHEN EVENTDATE >= '1701-01-01' AND EVENTDATE < '1801-01-01' THEN '18TH CENTURY'
            WHEN EVENTDATE >= '1801-01-01' AND EVENTDATE < '1901-01-01' THEN '19TH CENTURY'
			WHEN EVENTDATE >= '1901-01-01' AND EVENTDATE < '2001-01-01' THEN '20TH CENTURY'
			WHEN EVENTDATE >= '2001-01-01' THEN '21ST CENTURY'
			ELSE 'NULL'
			END AS CENTURY,
			COUNT(EVENTID)
			FROM TBLEVENT
			GROUP BY CUBE(CASE WHEN EVENTDATE >= '1701-01-01' AND EVENTDATE < '1801-01-01' THEN '18TH CENTURY'
            WHEN EVENTDATE >= '1801-01-01' AND EVENTDATE < '1901-01-01' THEN '19TH CENTURY'
			WHEN EVENTDATE >= '1901-01-01' AND EVENTDATE < '2001-01-01' THEN '20TH CENTURY'
			WHEN EVENTDATE >= '2001-01-01' THEN '21ST CENTURY'
			ELSE 'NULL'
			END)
			ORDER BY CENTURY;